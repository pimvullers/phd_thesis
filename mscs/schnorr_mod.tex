\begin{msc}{}

\setlength{\instwidth}{2\instwidth}
\setlength{\instdist}{1.5\instdist}
\setlength{\envinstdist}{1.5\envinstdist}

\declinst{P}{$(n, g), x, h = g^x$}{User}
\declinst{V}{$(n, g), h$}{Verifier}

\action*{
  $u \gets \Call{Random}{~}$ \\
  $a \gets g^u \mod n$}{P}
\nextlevel[3]

\mess{$a$}{P}{V}
\nextlevel[1]

\action*{$c \gets \Call{Random}{~}$}{V}
\nextlevel[2]

\mess{$c$}{V}{P}
\nextlevel[1]

\action*{$r \leftarrow u + c \cdot x$}{P}
\nextlevel[2]

\mess{$r$}{P}{V}
\nextlevel[1]

\action*{$g^r \stackrel{?}{\equiv} a \cdot h^c \mod n$}{V}
\nextlevel[1.5]

\end{msc}