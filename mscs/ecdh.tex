\begin{msc}{}

\fontfamily{\rmdefault}

\setlength{\instdist}{1.5\instdist}
\setlength{\envinstdist}{1.5\envinstdist}

\declinst{a}{$(E, \F{q}, a, b, P), x_1, Q_1 = x_1 \cdot P$}{$A$}
\declinst{b}{$(E, \F{q}, a, b, P), x_2, Q_2 = x_2 \cdot P$}{$B$}

\mess{$Q_1$}{a}{b}
\nextlevel[1]

\mess{$Q_2$}{b}{a}
\nextlevel[.5]

\action*{key $K = x_1 \cdot Q_2$}{a}
\action*{key $K = x_2 \cdot Q_1$}{b}
\nextlevel[1.2]

\end{msc}