\begin{msc}{}

\fontfamily{\rmdefault}

\setlength{\instdist}{1.5\instdist}
\setlength{\envinstdist}{1.5\envinstdist}

\declinst{a}{$(p, q, g)$}{$A$}
\declinst{b}{$(p, q, g)$}{$B$}

\action*{
  $x_1 \gets \Call{Random}{~}$ \\
  $h_1 \gets g^{x_1} \mod p$}{a}
\action*{
  $x_2 \gets \Call{Random}{~}$ \\
  $h_2 \gets g^{x_2} \mod p$}{b}
\nextlevel[3]

\mess{$h_1$}{a}{b}
\nextlevel[1]

\mess{$h_2$}{b}{a}
\nextlevel[1]

\action*{key $k = h_2^{x_1} \mod p$}{a}
\action*{key $k = h_1^{x_2} \mod p$}{b}
\nextlevel[1.2]

\end{msc}