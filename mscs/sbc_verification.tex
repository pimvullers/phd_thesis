\begin{msc}{}

\fontfamily{\rmdefault}

\setlength{\instwidth}{2\instwidth}
\setlength{\instdist}{1.5\instdist}
\setlength{\envinstdist}{1.5\envinstdist}

\declinst{c}{$k_U$,\, $P_U = k_U \cdot P_1$,\, $a$,\, $C_a = s_a \cdot P_U$}{User}
\declinst{t}{$P_2$,\, ($a,\, Q_a = s_a \cdot P_2$)}{Verifier}
\nextlevel[.5]

\action*{
  fresh blinding $b$ \\
  $C_b \gets b \cdot C_a$ \\
  $P_b \gets b \cdot P_U$
}{c}
\nextlevel[3.5]

\mess{$a, C_b, P_b$}{c}{t}
\nextlevel

\action*{
  verify $e(P_b, Q_a) \stackrel{?}{=} e(C_b, P_2)$
}{t}
\nextlevel[2.2]

\referencestart{p}{Proof of possession of $k_b = b \cdot k_U$}{c}{t}
\nextlevel[2]
\referenceend{p}
\nextlevel[.5]

\end{msc}