\begin{msc}{}

\fontfamily{\rmdefault}

\setlength{\instwidth}{2\instwidth}
\setlength{\instdist}{1.5\instdist}
\setlength{\envinstdist}{1.5\envinstdist}

\declinst{c}{$k_U, b$}{User}
\declinst{t}{$P_b, P_1$}{Verifier}

\action*{
  fresh nonce $n$ \\
  $N \gets n \cdot P_1$
}{t}
\nextlevel[3]

\mess{$N$}{t}{c}
\nextlevel

\action*{
  $R \gets b \cdot k_U \cdot N$
}{c}
\nextlevel[2]

\mess{$R$}{c}{t}
\nextlevel

\action*{
  verify $R \stackrel{?}{=} n \cdot P_b$
}{t}
\nextlevel[1.8]

\end{msc}