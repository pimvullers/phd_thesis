\begin{msc}{}

\setlength{\instwidth}{1.5\instwidth}

\declinst{P}{$h = g^x$}{Prover}
\declinst{V}{$g$, $h$}{Verifier}

\action*{$u \in_R \mathbb{Z}_p$\\ $a \leftarrow g^u$}{P}
\nextlevel[2.2]

\mess{$a$}{P}{V}
\nextlevel[.5]

\action*{$c \in_R \mathbb{Z}_p$}{V}
\nextlevel[1.5]

\mess{$c$}{V}{P}
\nextlevel[.5]

\action*{$r \leftarrow_p u + cx$}{P}
\nextlevel[1.5]

\mess{$r$}{P}{V}
\nextlevel[.5]

\action*{$g^r \stackrel{?}{=} a h^c$}{V}
\nextlevel[1.5]

\end{msc}
