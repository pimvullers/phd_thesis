\begin{msc}{}

\setlength{\instwidth}{1,5\instwidth}
\setlength{\instdist}{1.5\instdist}
\setlength{\envinstdist}{1.5\envinstdist}

\declinst{P}{$(p, q, g), x, h = g^x$}{User}
\declinst{V}{$(p, q, g), h$}{Verifier}

\action*{
  $u \gets \Call{Random}{~}$ \\
  $a \gets g^u \mod p$}{P}
\nextlevel[3]

\mess{$a$}{P}{V}
\nextlevel[1]

\action*{$c \gets \Call{Random}{~}$}{V}
\nextlevel[2]

\mess{$c$}{V}{P}
\nextlevel[1]

\action*{$r \gets u + c \cdot x \mod q$}{P}
\nextlevel[2]

\mess{$r$}{P}{V}
\nextlevel[1]

\action*{$g^r \stackrel{?}{=} a \cdot h^c \mod p$}{V}
\nextlevel[1.5]

\end{msc}